!function(){"use strict";var e=e=>{const t=window.themeCore.utils.cssClasses,r=window.themeCore.utils.Toggle,n=window.themeCore.utils.overlay,i=window.themeCore.utils.debounce,o={form:".js-form",emptyTitle:".js-template-empty-title",searchResultCounter:".js-search-result-counter",gridWrapper:".js-grid-wrapper",filterMenuOpenerWrapper:".js-filter-menu-opener-wrapper",filterMenuOpener:".js-filter-menu-opener",activeFiltersCounter:".js-active-filters-counter",selectedFiltersWrapper:".js-selected-filters-wrapper",filtersContainer:".js-filters-container",filterAccordionItem:".js-accordion-filter-item",filterLists:".js-filter-list",filterPrice:".js-filter-price",pagination:".js-pagination",loadMoreButton:".js-lazy-load",infiniteScroll:".js-infinite-scroll",filterMenuTitle:".js-filter-menu-title"},a={maxInput:".js-price-input-max",minInput:".js-price-input-min",rangeInputs:".js-range-inputs",minRange:".js-price-range-min",maxRange:".js-price-range-max",priceProgress:".js-price-progress"},s={collectionHeader:".js-collection-header",filterMenuToggler:"filterMenuToggler",paginationLink:".js-pagination-link",priceNumberInput:".js-price-input",priceRangeInput:".js-price-range",removeFilterLink:".js-remove-filter",resetFilters:".js-reset-filters",cssRoot:":root",header:"[data-header-container]",pageLoader:".js-page-preloader",...o,...a},c={fixed:"is-fixed",noEvents:"no-events",error:"is-error",withMargin:"with-margin",...t},l={priceFrom:"filter.v.price.gte",priceTo:"filter.v.price.lte"},u={query:"q",type:"type",optionsPrefix:"options[prefix]"},d={page:"page",sort:"sort_by",...u},p={rangeMin:"--range-min",rangeMax:"--range-max",headerHeight:"--header-height",headerOffsetTop:"--header-offset-top"},f={extraSmallScreen:window.matchMedia("(max-width: 767px)"),openMenuButtonObserver:null,infiniteScrollObserver:null,cssRoot:document.querySelector(s.cssRoot)},m=r({toggleSelector:s.filterMenuToggler,closeAccordionsOnHide:!1,toggleTabIndex:!1}),g=h(e,o),w=document.querySelector(s.pageLoader);function h(e,t){const r={};return Object.entries(t).forEach(([t,n])=>{const i=[...e.querySelectorAll(n)];r[t]=i.length?i.length>1?i:i[0]:null}),r}function v(e){if(e.matches)return f.openMenuButtonObserver.unobserve(g.filterMenuOpenerWrapper),void x();y()}function y(){if(!f.extraSmallScreen.matches){const e={rootMargin:`-${L()}px 0px 0px 0px`};f.openMenuButtonObserver=b(g.filterMenuOpenerWrapper,x,S,e)}}function L(){const e=f.cssRoot.style.getPropertyValue(p.headerHeight),t=f.cssRoot.style.getPropertyValue(p.headerOffsetTop);return parseInt(e)+parseInt(t)}function M(){f.infiniteScrollObserver=b(g.infiniteScroll,()=>(async function(e,t){e.unobserve(t);const r=window.location.origin+t.dataset.nextUrl;w.classList.add(c.active),await k(r),w.classList.remove(c.active)})(f.infiniteScrollObserver,g.infiniteScroll))}function b(e,t,r,n={}){const i=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?"function"==typeof t&&t():"function"==typeof r&&r()})},n);return i.observe(e),i}function x(){g.filterMenuOpener&&(g.filterMenuOpener.classList.remove(c.fixed),g.filterMenuTitle.classList.remove(c.withMargin))}function S(){g.filterMenuOpener&&!function(e){const t=L(),r=e.getBoundingClientRect();return t&&r.bottom>=t}(g.filterMenuOpenerWrapper)&&(g.filterMenuOpener.classList.add(c.fixed),g.filterMenuTitle.classList.add(c.withMargin))}async function j(t){const r=t.target.closest(s.form);if(!r||function(){if(!g.filterPrice)return!1;return[...g.filterPrice.querySelectorAll(s.priceNumberInput)].some(e=>e.classList.contains(c.error))}())return;const n=new FormData(r),i=[...n.keys()],{minInput:o,maxInput:d}=h(e,a);i.forEach(e=>{e!==l.priceFrom&&e!==l.priceTo||(e===l.priceFrom&&Number(o.value)===Number(o.min)||e===l.priceTo&&Number(d.value)===Number(d.max))&&n.delete(e)});const p=function(e){const t=new URLSearchParams(e).toString(),r=new URL(window.location.href),n=new URL(`${window.location.origin}${window.location.pathname}?${t}`);for(const e in u){const t=r.searchParams.get(u[e]);t&&n.searchParams.set(u[e],t)}return n}(n);r.classList.add(c.loading),await I(p),window.parent===window.top&&window.history.pushState({},null,p),r.classList.remove(c.loading),window.themeCore.Accordion.setTabIndex(".product-filters__form-accordion","hidden")}async function I(t){g.gridWrapper.ariaBusy="true";const r=O(t,e.id);!function(e){if(!e||!Object.keys(e).length)return;const{selectedFiltersWrapper:t,gridWrapper:r,filterMenuOpener:n,activeFiltersCounter:i,filterAccordionItem:o,filterPrice:a,pagination:l,loadMoreButton:u,infiniteScroll:d,searchResultCounter:p}=e;g.gridWrapper.innerHTML=r.innerHTML,r.innerHTML?(g.emptyTitle.classList.add(c.hidden),g.emptyTitle.ariaHidden="true"):(g.emptyTitle.classList.remove(c.hidden),g.emptyTitle.ariaHidden="false");if(g.filtersContainer){const e=g.filtersContainer.querySelectorAll(s.filterAccordionItem);Array.from(e).forEach(e=>{o&&0===Array.from(o).length?e.id!==o.id&&e.remove():Array.from(o).some(({id:t})=>e.id===t)||e.remove()})}o&&o.length&&o.forEach((e,t)=>{const r=document.getElementById(e.id);if(r){const t=r.querySelector(s.filterLists),n=e.querySelector(s.filterLists);if(!t||!n)return;t.innerHTML=n.innerHTML}else{if(t>0){const r=o[t-1],n=r.id;return void document.getElementById(n).after(e)}if(e.parentElement){const t=g.filtersContainer.querySelector(s.filterAccordionItem);t.before(e)}}});window.themeCore.Accordion.init(".product-filters__form-accordion"),g.filterMenuOpener.dataset.count=n?n.dataset.count:0,E({activeFiltersCounter:i,filterPrice:a,pagination:l,selectedFiltersWrapper:t,infiniteScroll:d,loadMoreButton:u,searchResultCounter:p}),d&&M(),a&&C()}(h(await T(r),o)),window.themeCore.LazyLoadImages.init(),g.gridWrapper.ariaBusy="false",window.themeCore.EventBus.emit("compare-products:init")}function O(t,r=e.id){const n=new URL(t);return n.searchParams.set("section_id",r),n.toString()}async function T(e){const t=await fetch(e),r=await t.text();return(new DOMParser).parseFromString(r,"text/html")}function C(){const{minInput:t,maxInput:r,rangeInputs:n}=h(e,a),{thumbOffset:i}=n.dataset,o=`calc(${Number(t.value)/Number(t.max)*100}% - ${i}px)`,s=`calc(${Number(r.value)/Number(r.max)*100}% + ${i}px)`;n.style.setProperty(p.rangeMin,o),n.style.setProperty(p.rangeMax,s)}function E(e){if(e&&Object.keys(e).length)for(const t in e)g[t]&&(g[t].replaceWith(e[t]),g[t]=e[t])}async function R(e){const t=e.target.closest(s.paginationLink);if(!t)return;e.preventDefault(),w.classList.add(c.active),t.classList.add(c.noEvents),x();let r=function(){const e=document.querySelector(s.header).hasAttribute("data-header-sticky")?L():0,t=document.querySelector(s.collectionHeader);if(!t)return 0;return window.pageYOffset+t.getBoundingClientRect().top-(e+10)}();window.scrollTo(0,r),window.parent===window.top&&window.history.pushState({},null,t.href),await I(t.href),w.classList.remove(c.active)}async function P(){n({namespace:"filters-template"}).open(),await I(window.location.href),n({namespace:"filters-template"}).close()}function B(t){const r=t.target.closest(s.priceNumberInput);if(!r)return;const{minInput:n,maxInput:i,minRange:o,maxRange:l}=h(e,a),u=i.value&&n.value&&Number(i.value)<=Number(i.max)&&Number(n.value)>=Number(n.min);if(Number(i.value)-Number(n.value)>=0&&u)return"min"===r.dataset.type?o.value=n.value:l.value=i.value,C(),void N(n,i);"min"===r.dataset.type?n.classList.add(c.error):i.classList.add(c.error)}function A(t){const r=t.target.closest(s.priceRangeInput);if(!r)return;const{minInput:n,maxInput:i,minRange:o,maxRange:c}=h(e,a);c.value-o.value<0&&("min"===r.dataset.type?o.value=n.value:c.value=i.value),n.value=o.value,i.value=c.value,N(n,i),C()}function N(...e){e.forEach(e=>e.classList.remove(c.error))}async function F(e){const t=e.target.closest(s.removeFilterLink);t&&(e.preventDefault(),g.form.classList.add(c.loading),await I(t.href),window.parent===window.top&&window.history.pushState({},null,t.href),g.form.classList.remove(c.loading),window.themeCore.Accordion.setTabIndex(".product-filters__form-accordion","hidden"))}async function W(e){if(!e.target.closest(s.resetFilters))return;const t=new URL(window.location.href);[...t.searchParams.keys()].filter(e=>e!==d.sort&&e!==d.query).forEach(e=>t.searchParams.delete(e)),g.form.classList.add(c.loading),await I(t),window.parent===window.top&&window.history.pushState({},null,t),g.form.classList.remove(c.loading),window.themeCore.Accordion.setTabIndex(".product-filters__form-accordion","hidden")}async function k(t){const r=O(t,e.id),n=await T(r),{gridWrapper:i,infiniteScroll:a,loadMoreButton:s}=h(n,o);g.gridWrapper.insertAdjacentHTML("beforeend",i.innerHTML),E({infiniteScroll:a,loadMoreButton:s}),a&&M(),window.themeCore.LazyLoadImages.init(),window.themeCore.EventBus.emit("compare-products:init")}async function H(e){const t=e.target.closest(s.loadMoreButton);if(!t)return;w.classList.add(c.active),t.classList.add(c.noEvents);const r=window.location.origin+t.dataset.nextUrl;await k(r),w.classList.remove(c.active)}return Object.freeze({init:function(){e&&Object.keys(g).length&&function(t){const{filterMenuOpenerWrapper:r,loadMoreButton:n,infiniteScroll:o,filterLists:a,filterPrice:s,pagination:c,form:l}=t;r&&(f.extraSmallScreen.addEventListener("change",v),m.init(),y(),window.addEventListener("resize",i(y,100,!1))),(a||s)&&e.addEventListener("click",F),s&&(C(),e.addEventListener("input",B),e.addEventListener("input",A)),(c||l)&&window.addEventListener("popstate",P),l&&e.addEventListener("change",j),a&&e.addEventListener("click",W),c&&e.addEventListener("click",R),n&&e.addEventListener("click",H),o&&M()}(g)}})};const t=()=>{window.themeCore.utils.registerExternalUtil(e,"ProductFilters")};window.themeCore&&window.themeCore.loaded?t():document.addEventListener("theme:all:loaded",t,{once:!0})}();