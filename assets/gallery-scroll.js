class GalleryScroll extends HTMLElement{constructor(){super(),this.currentImageIndex=0,this.images=[],this.isVisible=!1,this.observer=null,this.scrollMargin=.1}connectedCallback(){this.images=Array.from(this.querySelectorAll(".gallery-scroll__item")),0!==this.images.length&&(this.images.forEach((s,t)=>{s.style.position="absolute",s.style.opacity=0===t?"1":"0",s.style.transition="opacity 0.5s ease-in-out"}),this.parent=this.parentElement,this.parent&&(this.observer=new IntersectionObserver(s=>{s.forEach(s=>{s.isIntersecting?(this.isVisible=!0,this.startScrollTracking()):(this.isVisible=!1,this.stopScrollTracking())})},{threshold:.1}),this.observer.observe(this.parent)))}startScrollTracking(){this.scrollListener||(this.scrollListener=this.onWindowScroll.bind(this),window.addEventListener("scroll",this.scrollListener,{passive:!0}),this.onWindowScroll())}stopScrollTracking(){this.scrollListener&&(window.removeEventListener("scroll",this.scrollListener),this.scrollListener=null)}onWindowScroll(){if(!this.isVisible||!this.parent)return;const s=this.parent.getBoundingClientRect(),t=window.innerHeight,e=((t-s.top)/(t+s.height)-this.scrollMargin)/(1-2*this.scrollMargin),i=Math.max(0,Math.min(1,e)),r=Math.floor(i*this.images.length),l=Math.min(r,this.images.length-1);l!==this.currentImageIndex&&this.switchImage(l)}switchImage(s){s===this.currentImageIndex||s>=this.images.length||(this.images[this.currentImageIndex].style.opacity="0",this.images[s].style.opacity="1",this.style.height=`${this.images[s].offsetHeight}px`,this.currentImageIndex=s)}disconnectedCallback(){this.stopScrollTracking(),this.observer&&this.observer.disconnect()}}customElements.define("gallery-scroll",GalleryScroll);